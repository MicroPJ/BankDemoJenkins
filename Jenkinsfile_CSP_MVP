node {

    stage('Clone repository') {
        /* Let's make sure we have the repository cloned to our workspace */
        cleanWs()
	git branch: "main",
        url: 'https://github.com/MicroFocus/BankDemo.git'
    }

    stage('Build') {

    }

    stage('Release') {
	//Create System Release folder structure
	powershell '''
	New-Item -Path Release-env.BUILD_NUMBER-env.BUILD_ID -ItemType directory
	New-Item -Path Release-env.BUILD_NUMBER-env.BUILD_ID\\system -ItemType directory
	New-Item -Path Release-env.BUILD_NUMBER-env.BUILD_ID\\system\\catalog -ItemType directory
	New-Item -Path Release-env.BUILD_NUMBER-env.BUILD_ID\\system\\catalog\\data -ItemType directory
	New-Item -Path Release-env.BUILD_NUMBER-env.BUILD_ID\\system\\loadlib -ItemType directory
	New-Item -Path Release-env.BUILD_NUMBER-env.BUILD_ID\\system\\logs -ItemType directory
	New-Item -Path Release-env.BUILD_NUMBER-env.BUILD_ID\\system\\rdef -ItemType directory
	Copy-Item -Path "executables\\Windows\\x64\\core\\*" -Destination "Release-env.BUILD_NUMBER-env.BUILD_ID\\system\\loadlib"
	Compress-Archive -Path "Release-env.BUILD_NUMBER-env.BUILD_ID\\system" -DestinationPath "Release-env.BUILD_NUMBER-env.BUILD_ID.zip"
	'''
    }
    
    stage('Deploy') {

    }
    
    stage('Test') {  
//	    GroovyDsl.make {
//		    request {
//			method 'GET'
//			urlPath('https://api.ipify.org') {
//			    queryParameters {
//				parameter 'format': "json"
//			    }
//			}
//			headers {
//			    header 'Content-Type': 'application/json'
//			}
//			body ''
//		    }
//		    response {
//			status 200
//		    }
//	    }
    }
}
